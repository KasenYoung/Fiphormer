# 数据介绍

## 预测目标

预测目标为：5分钟后的**隐含波动率曲面**

隐含波动率可以理解为从期权合约价格到波动率维度的一个一一映射，一般会基于BS定价公式通过数值方法反解得到，在同一时刻，不同行权价和期限下的期权合约会对应不同的隐含波动率，它们共同构成了类似于下图的隐含波动率曲面

预测隐含波动率曲面会是一个比直接预测价格更加有意义的任务，原因在于：首先，对于不同品种，由于标的的差异可能造成合约的价格和变化规律相差甚远，例如etf期权和股指期权，如果直接预测价格序列，那么我们只能分别对不同品种训练（因为特性不同），而无法将它们共同放入一个数据集来训练，这样将大幅缩小训练的数据量，而我国的期权市场本就产品数量较少，这显然是不利于我们的预测任务的，因此我们选用隐含波动率曲面，这样可以将所有金融期权波动率曲面一起进行训练和预测，提高模型的稳定性和泛化能力；另外，在低流动性前提下，波动率曲面随时间变化较价格更为平滑，更有利于神经网络去拟合；最后，在实务中，期权交易员们也一般直接根据隐波曲面的变化规律来交易，更有甚者直接以隐波为报价单位，因此直接预测隐波曲面也是对接实务中的策略与研发。

波动率曲面的运动是极为复杂的，包括平移和形变，由此衍生出回归套利、偏度套利和峰度套利等多种策略，但这些运动一般是同时发生，即使是资深的期权交易员在同一时刻也往往仅仅能关注曲面的某一种运动规律（例如，专注于曲面上某条曲线的偏度）来交易，而借由图神经网络，我们可以同时让神经网络去拟合多种运动的复合，进一步实现多种策略的同时监控和交易。

因此，我们以5分钟为一个采样间隔，预测未来5分钟后的波动率曲面，这将作为我们的预测目标（label）

## 特征构建

对于每一个特定的合约，我们共有210个特征用于预测，所用原始数据来源于订单簿的数据。

首先从订单簿数据我们可以获得bid和ask价格，之后我们可以根据价格反解出隐含波动率（vol），进一步算出Greeks。Greeks为期权合约价格关于各种变量（例如，标的价格）的偏导数，它刻画了期权在当前的各项风险敞口，这些特征将作为价格维度提取出的特征。

此外，我们还对合约信息进行提取，例如价值状态（行权价/标的价格），到期日，认购/认沽等。这些特征为期权合约不随时间改变的特性（假设无展期等操作），对于类别变量，考虑独热编码的方式；对于时间型特征，进行简单编码（提取年月日时分秒等）。他们组成了合约本身属性维度的特征。

最后，为了扩展特征维度，并且充分利用5mi采样间隔内的价格信息，我们将采样间隔区间内的分钟线特征也加入到了样本特征中，例如说，对于10：05的样本，在10：01-10：04的4个分钟线数据会生成4份如上特征，我们将他们共同加入到10：05的特征中，这样10：05的特征维度会扩大5倍，有利于神经网络进一步提取更多的信息用于拟合。

每个时刻的曲面上的每个位置特征维度为210。

## 预测品种（样本空间）

为了扩展样本量，提升模型的精度和稳定性，我们将几种流动性较高的金融期权品种曲面数据放在一起训练，包括沪深300、上证50和中证500 etf或股指期权六个品种，这样每个时刻的图将有500左右个节点，让神经网络有更多的信息用于学习，并且使得训练更加稳定。

值得注意的是，由于流动性水平整体较低，在某些时刻会出现订单簿击穿的现象，对应合约会进入竞价，导致无法获得价格，进一步Greeks等也无法获取，为空值，我们在此暂时去掉这些数据，而不同时间发生上述现象的合约不同，导致可能不同时间的节点数量会有微小差异。为了解决这一点，后续可以考虑使用各种曲面模型来插值拟合缺失位置的隐波取值，然而，这是一个更加复杂且工程量大的问题，我们暂时搁置。
